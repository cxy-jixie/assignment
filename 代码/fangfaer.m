
A=[ 0.3*10^-15 59.14 3 1;
    5.291 -6.130 -1 2;
    11.2 9 5 2;
    1 2 1 1];
n=4;
x=zeros(4,1);	
b=[59.17;46.78;1;2];
B=[A,b];
for j=1:4
    [h,m]=max(A(j:4,j));			
    A([m+j-1,j],:)=A([j,m+j-1],:);
    for i=j+1:4						
        B(i,:)=B(i,:)-A(i,j)/A(j,j)*B(j,:);
        b(i)=b(i)-A(i,j)/A(j,j)*b(j);
    end
end				
x(4)=b(4)/B(4,4);
for f=3:-1:1						
    x(f)=(b(f)-sum(x.*A(f,:)'))/A(f,f);
end